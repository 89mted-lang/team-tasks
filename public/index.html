<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>График занятости сотрудников</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100">
  <div id="root"></div>
  <script type="text/javascript">
    const { useState, useEffect } = React;

    function App() {
      const [items, setItems] = useState([]);
      const [form, setForm] = useState({
        employee: '',
        type: 'Задача',
        title: '',
        start: '',
        end: ''
      });

      // Загрузка задач с сервера при старте
      useEffect(() => {
        fetch('/api/tasks')
          .then(res => res.json())
          .then(data => setItems(data));
      }, []);

      // Добавление задачи через сервер
      function addItem() {
        if (!form.employee || !form.type || !form.title || !form.start || !form.end) {
          alert('Заполните все поля');
          return;
        }
        const newTask = {
          employee: form.employee,
          type: form.type,
          title: form.title,
          start: form.start,
          end: form.end,
          comment: ''
        };
        fetch('/api/tasks', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(newTask)
        })
          .then(res => res.json())
          .then(added => setItems(items => [...items, added]));
      }

      return (
        React.createElement('div', { className: 'max-w-2xl mx-auto p-6 bg-white rounded shadow mt-8' },
          React.createElement('h1', { className: 'text-2xl font-bold mb-4' }, 'График занятости сотрудников'),
          React.createElement('div', { className: 'mb-4 grid grid-cols-2 gap-2' },
            React.createElement('input', {
              className: 'border p-2 rounded',
              placeholder: 'Сотрудник',
              value: form.employee,
              onChange: e => setForm({ ...form, employee: e.target.value })
            }),
            React.createElement('select', {
              className: 'border p-2 rounded',
              value: form.type,
              onChange: e => setForm({ ...form, type: e.target.value })
            },
              React.createElement('option', null, 'Задача'),
              React.createElement('option', null, 'Отпуск')
            ),
            React.createElement('input', {
              className: 'border p-2 rounded col-span-2',
              placeholder: 'Описание',
              value: form.title,
              onChange: e => setForm({ ...form, title: e.target.value })
            }),
            React.createElement('input', {
              className: 'border p-2 rounded',
              type: 'date',
              value: form.start,
              onChange: e => setForm({ ...form, start: e.target.value })
            }),
            React.createElement('input', {
              className: 'border p-2 rounded',
              type: 'date',
              value: form.end,
              onChange: e => setForm({ ...form, end: e.target.value })
            })
          ),
          React.createElement('button', {
            className: 'bg-blue-600 text-white px-4 py-2 rounded mb-6',
            onClick: addItem
          }, 'Добавить задачу'),
          React.createElement('h2', { className: 'text-lg font-semibold mb-2' }, 'Список задач'),
          React.createElement('table', { className: 'w-full border' },
            React.createElement('thead', null,
              React.createElement('tr', null,
                React.createElement('th', { className: 'border p-2' }, 'Сотрудник'),
                React.createElement('th', { className: 'border p-2' }, 'Тип'),
                React.createElement('th', { className: 'border p-2' }, 'Описание'),
                React.createElement('th', { className: 'border p-2' }, 'Начало'),
                React.createElement('th', { className: 'border p-2' }, 'Окончание')
              )
            ),
            React.createElement('tbody', null,
              items.map(task =>
                React.createElement('tr', { key: task.id },
                  React.createElement('td', { className: 'border p-2' }, task.employee),
                  React.createElement('td', { className: 'border p-2' }, task.type),
                  React.createElement('td', { className: 'border p-2' }, task.title),
                  React.createElement('td', { className: 'border p-2' }, task.start),
                  React.createElement('td', { className: 'border p-2' }, task.end)
                )
              )
            )
          )
        )
      );
    }

    ReactDOM.render(React.createElement(App), document.getElementById('root'));
  </script>
</body>
</html>